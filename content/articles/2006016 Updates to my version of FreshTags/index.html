---
title: Updates to my version of FreshTags
date: 2006-01-16 12:05:00 Z
tags: ["Tech","Tagging","Blogger","Hack","Hacks","Freshtags"]
wordpress_path: /2006/01/updates-to-my-version-of-freshtags
---
I have been doing some work on <a href="http://singpolyma-tech.blogspot.com/2005/11/in-blog-tag-viewing.html">my version</a> of the <a href="http://ghill.customer.netspace.net.au/freshtags/index.html">FreshTags</a> concept.  The first major addition is the ability to pull in other FreshTags users' data for use in the sidebar.  If you look at my links sidebar you'll see a '+' to the left of some items.  Only two of these use FreshTags, Freshblog and Ecmanaut.  If you click the '+' next to either of these when there is no query tag you will be presented with a list of the newest posts from those blogs.  If there <span style="font-style: italic;">is</span> a tag selected, however, you will be presented with a list of posts on those blogs matching that tag, unless they have none in which case the list of newest posts is again presented.  The template code to do this (without the show/hide magic) is:
<code>&lt;script type="text/javascript"&gt;dynamic_delicious_load('<span style="color: rgb(255, 0, 0);">DELICIOUS USER</span>','<span style="color: rgb(255, 0, 0);">ANCHOR TAG</span>',function(){write_tagged_posts(false,false,'<span style="color: rgb(255, 0, 0);">FEED URL</span>');});&lt;/script&gt;</code>
The three parameters passed to write_tagged_posts are:
<ol><li>extendedyes -- TRUE to display the contents of the extended field, otherwise FALSE
</li><li>hideonnull -- TRUE to have blank output if there are no post matches, otherwise FALSE</li><li>feedurl -- The URL to the feed for this item, do not pass if you don't know it or don't want to display recent items on no match</li><li><b title="Update 2006-01-17">max -- # limit of posts to display, not shown in example above</b></li></ol>The second major addition is to the fetch_query_tag function.  If no tag has been passed to the page, and it cannot find one in the referrer URL then it looks in the current page.  It grabs the first rel=tag item and uses the contents of that as query_tag.  Thus if a tag cannot be found any other way it finds related posts to the current one.  The only minor problem with this addition is that including the JavaScript in the header means fetch_query_tag runs before the page has fully loaded, so it will usually not find anything.  I solved this by moving the block that includes the main Delicious.posts and the tagspostpage.js to my sidebar, which is after my posts in my code.  If your sidebar comes before your posts you're stuck, because you need it loaded before the sidebar for the list_side_tags function to work.  If anyone knows of a way around this I would appreciate knowing.

<b title="Update 2006-01-17">I was unable to actually hook this to onload (per <a href="http://singpolyma-tech.blogspot.com/2006/01/updates-to-my-version-of-freshtags.html#c113742720318718104">Johan's comment</a>) because the data must be loaded <i>before</i> list_side_tags or write_tagged_posts can be run.  I found a solution in using the callbacks again, and this time list_side_tags will load tags if they are unloaded when called and same for posts for write_tagged_posts.  return_tagged_posts can therefore not be called until one of these others (or you call load_data('posts') yourself), however since the main use of return_tagged_posts is at the end of the code, after write_tagged_posts, for use on the inline tags page, this should not be a problem.  So autocapture should now work without modifying your template code to move the javascript stuff from the &lt;haed&gt; section.

If you place code similar to:
<code>&lt;MainPage&gt;&lt;script type="text/javascript"&gt;var no_autocapture = true;&lt;/script&gt;&lt;/MainPage&gt;</code>
in your &lt;head&gt; section it will stop the tag autocapture on your main page (per <a href="http://singpolyma-tech.blogspot.com/2006/01/updates-to-my-version-of-freshtags.html#c113748502873895565">Richard's comment</a>)</b>
